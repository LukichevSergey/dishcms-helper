<?php
use common\components\helpers\HHtml;

$tourRoutePoints=$model->routePointBehavior->get(true);
$tourStartDates=$model->startDateBehavior->get(true);
$tourPhotos=$model->getPhotos();
?>

<div class="tour-cart-main">
   <div class="price-tour"><?= HHtml::price($model->price) ?> руб. / <?= $model->getDurationLabel(); ?></div>
    <? if(!empty($tourRoutePoints)): ?>
    <div class='tour-cart__descr'>
    	<h2>Примерная <br/> нитка маршрута:</h2>
    	<ul><li><?= implode('</li><li>', array_column($tourRoutePoints, 'title')); ?></li></ul>
    </div>
    <? endif; ?>
<div class="tours-info">
	<div class="svg-cal"><svg width="55" height="46" fill="none" xmlns="http://www.w3.org/2000/svg">
         <path d="M54.03 4.544h-1.473V3.32c0-1.83-1.49-3.32-3.32-3.32a3.324 3.324 0 00-3.321 3.32v1.224h-.656V3.32c0-1.83-1.488-3.32-3.32-3.32a3.322 3.322 0 00-3.317 3.32v1.224h-.66V3.32c0-1.83-1.488-3.32-3.317-3.32a3.324 3.324 0 00-3.32 3.32v1.224h-.657V3.32c0-1.83-1.49-3.32-3.32-3.32-1.83 0-3.32 1.49-3.32 3.32v1.224h-.656V3.32c0-1.83-1.488-3.32-3.32-3.32a3.322 3.322 0 00-3.318 3.32v1.224h-.66V3.32c0-1.83-1.487-3.32-3.316-3.32-1.83 0-3.32 1.49-3.32 3.32v1.224h-.657V3.32C8.782 1.49 7.294 0 5.462 0a3.322 3.322 0 00-3.317 3.32v1.224H.67A.668.668 0 000 5.212v40.12c0 .369.3.668.669.668h53.36c.37 0 .67-.3.67-.668V5.212c0-.369-.3-.668-.67-.668zM47.252 3.32c0-1.094.89-1.984 1.984-1.984 1.093 0 1.983.89 1.983 1.984v1.224h-3.967V3.32zm-7.293 0c0-1.094.888-1.984 1.984-1.984 1.091 0 1.979.89 1.979 1.984v1.224H39.96V3.32zm-7.297 0c0-1.094.89-1.984 1.983-1.984 1.092 0 1.98.89 1.98 1.984v1.224h-3.963V3.32zm-7.297 0c0-1.094.89-1.984 1.983-1.984 1.094 0 1.983.89 1.983 1.984v1.224h-3.966V3.32zm-7.293 0c0-1.094.888-1.984 1.983-1.984 1.091 0 1.98.89 1.98 1.984v1.224h-3.963V3.32zm-7.297 0c0-1.094.89-1.984 1.983-1.984 1.091 0 1.98.89 1.98 1.984v1.224h-3.963V3.32zm-7.293 0c0-1.094.888-1.984 1.983-1.984 1.091 0 1.979.89 1.979 1.984v1.224H3.483V3.32zm3.962 2.56v.286a1.984 1.984 0 01-1.98 1.985.668.668 0 100 1.336 3.322 3.322 0 003.317-3.32V5.88h5.956v.286a1.984 1.984 0 01-1.979 1.985.668.668 0 100 1.336 3.322 3.322 0 003.317-3.32V5.88h5.96v.286a1.984 1.984 0 01-1.98 1.985.668.668 0 100 1.336c1.829 0 3.317-1.49 3.317-3.32V5.88h5.96v.286c0 1.094-.89 1.985-1.984 1.985a.668.668 0 100 1.336c1.831 0 3.32-1.49 3.32-3.32V5.88h5.956v.286a1.984 1.984 0 01-1.979 1.985.668.668 0 100 1.336 3.322 3.322 0 003.317-3.32V5.88h5.96v.286a1.984 1.984 0 01-1.98 1.985.668.668 0 100 1.336 3.322 3.322 0 003.317-3.32V5.88h5.96v.286c0 1.094-.89 1.985-1.983 1.985a.668.668 0 100 1.336c1.83 0 3.32-1.49 3.32-3.32V5.88h.804v7.68H1.337V5.88h6.108zM1.337 44.664V14.896h52.024v29.768H1.337z" fill="#015A43"/>
         <path d="M48.549 24.379H34.032c-.369 0-.668.3-.668.668v14.795c0 .369.299.668.668.668H48.55c.369 0 .669-.3.669-.668V25.047c0-.369-.3-.668-.67-.668zm-.669 14.795H34.7v-13.46h13.18v13.46z" fill="#015A43"/>
         <path d="M40.502 37.041a4.628 4.628 0 003.483-.785 4.64 4.64 0 001.909-3.027.668.668 0 00-1.318-.225 3.312 3.312 0 01-1.363 2.161 3.303 3.303 0 01-2.485.56 3.302 3.302 0 01-2.154-1.357 3.3 3.3 0 01-.565-2.483 3.341 3.341 0 013.848-2.721.669.669 0 10.224-1.317 4.68 4.68 0 00-5.39 3.812 4.626 4.626 0 00.791 3.481 4.628 4.628 0 003.02 1.901z" fill="#015A43"/>
         <path d="M40.294 31a.67.67 0 00-.97.92l1.484 1.56a.667.667 0 00.911.054l4.738-3.924a.667.667 0 10-.854-1.029l-4.256 3.526L40.294 31zM9.208 16.797H5.136c-.369 0-.668.299-.668.668v4.071c0 .369.3.668.668.668h4.072c.37 0 .669-.3.669-.668v-4.072c0-.368-.3-.667-.669-.667zm-.668 4.071H5.805v-2.735H8.54v2.735zM15.873 16.797h-4.072c-.37 0-.669.299-.669.668v4.071c0 .369.3.668.67.668h4.071c.37 0 .669-.3.669-.668v-4.072c0-.368-.3-.667-.669-.667zm-.668 4.071H12.47v-2.735h2.734v2.735zM22.538 16.797h-4.073c-.369 0-.668.299-.668.668v4.071c0 .369.3.668.668.668h4.073c.369 0 .668-.3.668-.668v-4.072c0-.368-.3-.667-.668-.667zm-.67 4.071h-2.734v-2.735h2.735v2.735zM29.202 16.797H25.13c-.37 0-.668.299-.668.668v4.071c0 .369.299.668.668.668h4.072c.37 0 .669-.3.669-.668v-4.072c0-.368-.3-.667-.669-.667zm-.669 4.071H25.8v-2.735h2.735v2.735zM9.208 23.677H5.136c-.369 0-.668.3-.668.668v4.072c0 .368.3.668.668.668h4.072c.37 0 .669-.3.669-.668v-4.072c0-.369-.3-.668-.669-.668zM8.54 27.75H5.805v-2.736H8.54v2.736zM15.873 23.677h-4.072c-.37 0-.669.3-.669.668v4.072c0 .368.3.668.67.668h4.071c.37 0 .669-.3.669-.668v-4.072c0-.369-.3-.668-.669-.668zm-.668 4.072H12.47v-2.736h2.734v2.736zM22.538 23.677h-4.073c-.369 0-.668.3-.668.668v4.072c0 .368.3.668.668.668h4.073c.369 0 .668-.3.668-.668v-4.072c0-.369-.3-.668-.668-.668zm-.67 4.072h-2.734v-2.736h2.735v2.736zM29.202 23.677H25.13c-.37 0-.668.3-.668.668v4.072c0 .368.299.668.668.668h4.072c.37 0 .669-.3.669-.668v-4.072c0-.369-.3-.668-.669-.668zm-.669 4.072H25.8v-2.736h2.735v2.736zM9.208 30.557H5.136c-.369 0-.668.299-.668.668v4.071c0 .369.3.668.668.668h4.072c.37 0 .669-.3.669-.668v-4.071c0-.37-.3-.668-.669-.668zm-.668 4.071H5.805v-2.735H8.54v2.735zM15.873 30.557h-4.072c-.37 0-.669.299-.669.668v4.071c0 .369.3.668.67.668h4.071c.37 0 .669-.3.669-.668v-4.071c0-.37-.3-.668-.669-.668zm-.668 4.071H12.47v-2.735h2.734v2.735zM22.538 30.557h-4.073c-.369 0-.668.299-.668.668v4.071c0 .369.3.668.668.668h4.073c.369 0 .668-.3.668-.668v-4.071c0-.37-.3-.668-.668-.668zm-.67 4.071h-2.734v-2.735h2.735v2.735zM29.202 30.557H25.13c-.37 0-.668.299-.668.668v4.071c0 .369.299.668.668.668h4.072c.37 0 .669-.3.669-.668v-4.071c0-.37-.3-.668-.669-.668zm-.669 4.071H25.8v-2.735h2.735v2.735zM9.208 37.444H5.136c-.369 0-.668.299-.668.667v4.065c0 .37.3.668.668.668h4.072c.37 0 .669-.299.669-.668v-4.065c0-.368-.3-.667-.669-.667zm-.668 4.064H5.805V38.78H8.54v2.73zM15.873 37.444h-4.072c-.37 0-.669.299-.669.667v4.065c0 .37.3.668.67.668h4.071c.37 0 .669-.299.669-.668v-4.065c0-.368-.3-.667-.669-.667zm-.668 4.064H12.47V38.78h2.734v2.73zM22.538 37.444h-4.073c-.369 0-.668.299-.668.667v4.065c0 .37.3.668.668.668h4.073c.369 0 .668-.299.668-.668v-4.065c0-.368-.3-.667-.668-.667zm-.67 4.064h-2.734V38.78h2.735v2.73zM29.202 37.444H25.13c-.37 0-.668.299-.668.667v4.065c0 .37.299.668.668.668h4.072c.37 0 .669-.299.669-.668v-4.065c0-.368-.3-.667-.669-.667zm-.669 4.064H25.8V38.78h2.735v2.73z" fill="#015A43"/>
      </svg></div>
   <div class="days-tour">
	<div class="days-tour__date">Даты туров:</div>
	<?
	    if(!empty($tourStartDates)) { 
 	    	$tourStartDatesItems=[];$ruMonths=['января', 'февраля', 'марта', 'апреля', 'мая', 'июня', 'июля', 'августа', 'сентября', 'октября', 'ноября', 'декабря'];
	    	foreach($tourStartDates as $tourStartDate) { try { $date=date_create_from_format('d.m.Y', $tourStartDate['date']); if($date->format('d.m.Y') == $tourStartDate['date']) {
    			$sDate=$date->format('j') . ' ' . $ruMonths[(int)$date->format('n')-1] . ' ' . $date->format('Y');
	    		if((int)$model->duration > 0) {
	    			$date->modify('+' . (int)$model->duration . ' days');
	    			$sDate.=' - ' . $date->format('j') . ' ' . $ruMonths[(int)$date->format('n')-1] . ' ' . $date->format('Y');
	    		}
	    		$tourStartDatesItems[]=$sDate;
	    	}} catch(\Exception $e) {} }
	    	echo implode('<br/>', $tourStartDatesItems);
    	}
    	else { echo 'уточняйте у туроператора'; }
    ?>
   </div>
</div>
<? if(!empty($tourPhotos)): ?>
<div class="slide-outer">
<div class="arrows-tours__slide">
 <div class="tour-arrow__prev"><svg width="25" height="73" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M25 69v4L0 36.499 25 0v3.5L3 36.499 25 69z" fill="#EAEDF2"/></svg></div>
	<div class="tour-arrow__next"><svg width="25" height="73" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 69v4l25-36.501L0 0v3.5l22 32.999L0 69z" fill="#EAEDF2"/></svg></div>
   <div class='slide-tour'>
   	<? foreach($tourPhotos as $photo): ?>
	   <div class="div-img__tour"><img src="<?= $photo->getUrl(); ?>" alt=""></div>
	<? endforeach; ?>
	</div>
</div>
</div>
<? endif; ?>
</div>

<div class="wrapper">
	<div class="tabs-links">
		<div class="tab">О туре</div>
		<div class="tab">Что взять с собой</div>
		<div class="tab">Как добраться</div>
	</div>

	<div class="tabs-content">	
		<div class='tab_item' style ='display:block'><?= $model->about_text; ?></div>
		<div class='tab_item' style ='display:none'><?= $model->brings_text; ?></div>
		<div class='tab_item' style ='display:none'><?= $model->howgetus_text;  ?></div>
    </div>
</div>

